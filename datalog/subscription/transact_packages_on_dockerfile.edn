[:find
 (pull
   ?docker-file
   [:db/id
    :schema/entity-type
    :docker.file/path
    :docker.file/sha
    {(:docker.file.line/_file :as :docker.file/lines) [:docker.file.line/number
                                                       :docker.file.line/instruction
                                                       :docker.file.line/args-map
                                                       :docker.file.line/args-array
                                                       :docker.file.line/args-string]}])
 :in $ $before-db % ?ctx
 :where
 (attributes-tx ?ctx ?docker-file :docker.file/commit _)
 [?docker-file-line :docker.file.line/file ?docker-file]]
